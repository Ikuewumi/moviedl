import{d as N,u as V,l as m,r as y,i as p,X as E,w as S,y as U,o as G,b as O,c as u,e as k,s as P,m as w,j as R,x as D,g as c,h as x,t as T,F as X,f as q,D as I,a as L}from"./index.be173f1f.js";import{_ as H,a as J}from"./Comments.db00f8fd.js";import{_ as K}from"./Metadata.0bc40099.js";const Q={key:0,class:"relative","data-page-movie":""},W=c("span",{class:"f-e f-size-tiny"},"\u270F",-1),Y={class:"grid g-4","data-component-metadata":""},Z={class:"mbl-9","data-padded":""},ee={class:"links g-5 pt-5 pb-5","data-padded":"","data-links":""},se=N({props:["id"],async setup($){var b;let d,v;const s=$,r=V();m(()=>I.imdbId.test(s.id)?s.id:(a.value.pinia.toast.show("Invalid imdbID"),!1));let e=y({}),_=p("wrapFn");const C=p("pinia");let a=y({pinia:C(),title:p("title"),type:"movies",isLoaded:m(()=>{var t,i,l,o,n;return e.value?(((i=(t=e.value)==null?void 0:t._id)==null?void 0:i.length)===24&&a.value.title((l=e.value)==null?void 0:l.Title),((n=(o=e.value)==null?void 0:o._id)==null?void 0:n.length)===24):!1}),imdbID:m(()=>I.imdbId.test(s.id)?s.id:(a.value.pinia.toast.show("Invalid imdbID",!0),!1))});a.value.title("Movie Page");const F=async()=>{var i;e.value={};const t=async()=>await L(`public/${a.value.type}/${r.params.id}`);e.value=(i=await _("Loading Movie details",t))!=null?i:{}};E(r,()=>{r.name==="movie"&&r.params.id!==s.id&&F()});const M=async()=>await L(`public/${a.value.type}/${a.value.imdbID}`);e.value=(b=([d,v]=S(()=>_("Loading Movie details",M)),d=await d,v(),d))!=null?b:{};const j=t=>new Date(t).toLocaleDateString([],{month:"long",day:"2-digit",year:"numeric"}),B=U();return G(),(t,i)=>{var o,n,f,g,h;const l=O("router-link");return a.value.isLoaded?(u(),k("div",Q,[(o=P(B).getUser)!=null&&o.admin?(u(),w(l,{key:0,to:`/edit?type=movies&imdbid=${e.value.imdbID}`,class:"bar absolute pin-4 pbl-2 f-size-medium c-white bg-blue br-4 flex a-center j-center g-2"},{default:R(()=>[W]),_:1},8,["to"])):D("",!0),c("div",Y,[x(K,{data:e.value},null,8,["data"])]),c("time",Z,"Last updated on: "+T(j((h=(g=(n=e.value)==null?void 0:n.updatedAt)!=null?g:(f=e.value)==null?void 0:f.createdAt)!=null?h:"")),1),c("div",ee,[(u(!0),k(X,null,q(e.value.MovieLinks,(z,A)=>(u(),w(J,{key:A,data:z},null,8,["data"]))),128))]),x(H,{imdbID:a.value.imdbID},null,8,["imdbID"])])):D("",!0)}}});export{se as default};
