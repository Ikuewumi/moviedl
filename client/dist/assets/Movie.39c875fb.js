import{d as N,u as V,l as m,r as y,i as p,X as E,w as R,y as S,o as U,b as G,c as u,e as k,s as H,m as w,j as O,x as D,g as c,h as x,t as P,F as T,f as X,D as I,a as L,H as q}from"./index.5bca4349.js";import{_ as J,a as K}from"./Comments.33efeb4f.js";import{_ as Q}from"./Metadata.d4b0adfe.js";const W={key:0,class:"relative","data-page-movie":""},Y=c("span",{class:"f-e f-size-tiny"},"\u270F",-1),Z={class:"grid g-4","data-component-metadata":""},ee={class:"mbl-9","data-padded":""},ae={class:"links g-5 pt-5 pb-5","data-padded":"","data-links":""},oe=N({props:["id"],async setup($){var b;let r,v;const s=$,d=V();m(()=>I.imdbId.test(s.id)?s.id:(a.value.pinia.toast.show("Invalid imdbID"),!1));let e=y({}),_=p("wrapFn");const C=p("pinia");let a=y({pinia:C(),title:p("title"),type:"movies",isLoaded:m(()=>{var t,i,l,o,n;return e.value?(((i=(t=e.value)==null?void 0:t._id)==null?void 0:i.length)===24&&a.value.title((l=e.value)==null?void 0:l.Title),((n=(o=e.value)==null?void 0:o._id)==null?void 0:n.length)===24):!1}),imdbID:m(()=>I.imdbId.test(s.id)?s.id:(a.value.pinia.toast.show("Invalid imdbID",!0),!1))});a.value.title("Movie Page");const F=async()=>{var i;e.value={};const t=async()=>await L(`public/${a.value.type}/${d.params.id}`);e.value=(i=await _("Loading Movie details",t))!=null?i:{}};E(d,()=>{d.name==="movie"&&d.params.id!==s.id&&F()});const M=async()=>await L(`public/${a.value.type}/${a.value.imdbID}`);e.value=(b=([r,v]=R(()=>_("Loading Movie details",M)),r=await r,v(),r))!=null?b:{};const j=t=>new Date(t).toLocaleDateString([],{month:"long",day:"2-digit",year:"numeric"}),B=S();return U(t=>{console.error(t),q().push("/404")}),(t,i)=>{var o,n,f,g,h;const l=G("router-link");return a.value.isLoaded?(u(),k("div",W,[(o=H(B).getUser)!=null&&o.admin?(u(),w(l,{key:0,to:`/edit?type=movies&imdbid=${e.value.imdbID}`,class:"bar absolute pin-4 pbl-2 f-size-medium c-white bg-blue br-4 flex a-center j-center g-2"},{default:O(()=>[Y]),_:1},8,["to"])):D("",!0),c("div",Z,[x(Q,{data:e.value},null,8,["data"])]),c("time",ee,"Last updated on: "+P(j((h=(g=(n=e.value)==null?void 0:n.updatedAt)!=null?g:(f=e.value)==null?void 0:f.createdAt)!=null?h:"")),1),c("div",ae,[(u(!0),k(T,null,X(e.value.MovieLinks,(z,A)=>(u(),w(K,{key:A,data:z},null,8,["data"]))),128))]),x(J,{imdbID:a.value.imdbID},null,8,["imdbID"])])):D("",!0)}}});export{oe as default};
